<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Script Flow — Versão Final Completa</title>
  <style>
    body {font-family: Arial, sans-serif; margin:0; padding:0; background:#f5f5f5;}
    header {background:#222; color:#fff; padding:1rem; text-align:center;}
    .tabs {display:flex; background:#333;}
    .tabs button {flex:1; padding:1rem; background:#333; color:#fff; border:none; cursor:pointer;}
    .tabs button.active {background:#555;}
    .tabcontent {display:none; padding:1rem;}
    textarea, input[type=text] {width:100%; padding:.5rem; margin:.5rem 0; border:1px solid #ccc; border-radius:4px;}
    .editor-toolbar button {margin:0 .25rem;}
    .chat-container {display:flex; flex-direction:column; height:80vh; border:1px solid #ccc; border-radius:8px; overflow:hidden;}
    .chat-messages {flex:1; padding:1rem; overflow-y:auto; background:#e5ddd5;}
    .chat-input {display:flex;}
    .chat-input input {flex:1; padding:1rem; border:none;}
    .chat-input button {padding:1rem; background:#128c7e; color:#fff; border:none; cursor:pointer;}
    .message {max-width:70%; margin-bottom:.5rem; padding:.5rem 1rem; border-radius:16px; clear:both;}
    .message.sent {background:#dcf8c6; margin-left:auto;}
    .message.received {background:#fff; margin-right:auto;}
    .meet-container {display:flex; flex-direction:column; height:80vh; background:#000; color:#fff;}
    .meet-grid {flex:1; display:grid; grid-template-columns:repeat(auto-fit,minmax(200px,1fr)); gap:.5rem; padding:.5rem;}
    .meet-video {background:#222; display:flex; align-items:center; justify-content:center; border-radius:8px;}
    .meet-controls {display:flex; justify-content:center; background:#111; padding:.5rem;}
    .meet-controls button {margin:0 .5rem; padding:.5rem 1rem; border:none; border-radius:4px; cursor:pointer;}
    .storyboard-grid {display:grid; grid-template-columns:repeat(auto-fit,minmax(250px,1fr)); gap:1rem;}
    .storyboard-card {background:#fff; border:1px solid #ccc; border-radius:8px; padding:1rem;}
    .storyboard-card img {width:100%; border-radius:8px; margin-bottom:.5rem;}
  </style>
</head>
<body>
  <header><h1>Script Flow — Plataforma Completa</h1></header>
  <div class="tabs">
    <button class="tablink active" onclick="openTab(event,'argumento')">Argumento</button>
    <button class="tablink" onclick="openTab(event,'escaleta')">Escaleta</button>
    <button class="tablink" onclick="openTab(event,'roteiro')">Roteiro</button>
    <button class="tablink" onclick="openTab(event,'tratamento')">Tratamento</button>
    <button class="tablink" onclick="openTab(event,'biblia')">Bíblia</button>
    <button class="tablink" onclick="openTab(event,'storyboard')">Storyboard</button>
    <button class="tablink" onclick="openTab(event,'fofoca')">Fofoca</button>
    <button class="tablink" onclick="openTab(event,'chama')">Chama</button>
  </div>

  <!-- Argumento -->
  <div id="argumento" class="tabcontent" style="display:block">
    <h2>Argumento</h2>
    <textarea id="arg_storyline" placeholder="Storyline..."></textarea>
    <textarea id="arg_logline" placeholder="Logline..."></textarea>
    <textarea id="arg_sinopse" placeholder="Sinopse..."></textarea>
    <textarea id="arg_argumento" placeholder="Argumento..."></textarea>
    <button onclick="saveArgumento()">Salvar</button>
  </div>

  <!-- Escaleta -->
  <div id="escaleta" class="tabcontent">
    <h2>Escaleta</h2>
    <textarea id="escaleta_text"></textarea>
    <button onclick="saveEscaleta()">Salvar</button>
  </div>

  <!-- Roteiro -->
  <div id="roteiro" class="tabcontent">
    <h2>Roteiro</h2>
    <textarea id="roteiro_text"></textarea>
    <button onclick="saveRoteiro()">Salvar</button>
  </div>

  <!-- Tratamento -->
  <div id="tratamento" class="tabcontent">
    <h2>Tratamento</h2>
    <textarea id="tratamento_text"></textarea>
    <button onclick="saveTratamento()">Salvar</button>
  </div>

  <!-- Bíblia -->
  <div id="biblia" class="tabcontent">
    <h2>Bíblia</h2>
    <label>Capa:</label>
    <input type="file" id="biblia_capa" accept="image/*" onchange="previewCapa(event)">
    <img id="biblia_capa_preview" style="max-width:200px; display:block; margin:1rem 0">
    <textarea id="biblia_storyline" placeholder="Storyline..."></textarea>
    <textarea id="biblia_logline" placeholder="Logline..."></textarea>
    <textarea id="biblia_sinopse" placeholder="Sinopse..."></textarea>
    <textarea id="biblia_visual" placeholder="Projeto Visual..."></textarea>
    <textarea id="biblia_episodios" placeholder="Episódios..."></textarea>
    <button onclick="saveBiblia()">Salvar</button>
  </div>

  <!-- Storyboard -->
  <div id="storyboard" class="tabcontent">
    <h2>Storyboard</h2>
    <div class="storyboard-grid" id="storyboard_grid"></div>
    <button onclick="addQuadro()">+ Adicionar Quadro</button>
  </div>

  <!-- Fofoca -->
  <div id="fofoca" class="tabcontent">
    <h2>Fofoca</h2>
    <div class="chat-container">
      <div class="chat-messages" id="chatMessages"></div>
      <div class="chat-input">
        <input type="text" id="chatInput" placeholder="Digite uma mensagem...">
        <button onclick="sendMessage()">Enviar</button>
      </div>
    </div>
  </div>

  <!-- Chama -->
  <div id="chama" class="tabcontent">
    <h2>Chama</h2>
    <div class="meet-container">
      <div class="meet-grid" id="meetGrid"></div>
      <div class="meet-controls">
        <button onclick="toggleCam()">Câmera</button>
        <button onclick="toggleMic()">Mic</button>
        <button onclick="shareScreen()">Compartilhar Tela</button>
        <button onclick="endCall()">Encerrar</button>
      </div>
    </div>
  </div>

  <script>
    // Navegação abas
    function openTab(evt, tabName) {
      var i, tabcontent, tablink;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i=0; i<tabcontent.length; i++) {tabcontent[i].style.display="none";}
      tablink = document.getElementsByClassName("tablink");
      for (i=0; i<tablink.length; i++) {tablink[i].classList.remove("active");}
      document.getElementById(tabName).style.display="block";
      evt.currentTarget.classList.add("active");
    }

    // Argumento save/load
    function saveArgumento(){
      localStorage.setItem('arg_storyline',document.getElementById('arg_storyline').value);
      localStorage.setItem('arg_logline',document.getElementById('arg_logline').value);
      localStorage.setItem('arg_sinopse',document.getElementById('arg_sinopse').value);
      localStorage.setItem('arg_argumento',document.getElementById('arg_argumento').value);
    }
    window.onload = function(){
      document.getElementById('arg_storyline').value = localStorage.getItem('arg_storyline')||'';
      document.getElementById('arg_logline').value = localStorage.getItem('arg_logline')||'';
      document.getElementById('arg_sinopse').value = localStorage.getItem('arg_sinopse')||'';
      document.getElementById('arg_argumento').value = localStorage.getItem('arg_argumento')||'';
      document.getElementById('escaleta_text').value = localStorage.getItem('escaleta_text')||'';
      document.getElementById('roteiro_text').value = localStorage.getItem('roteiro_text')||'';
      document.getElementById('tratamento_text').value = localStorage.getItem('tratamento_text')||'';
      document.getElementById('biblia_storyline').value = localStorage.getItem('biblia_storyline')||'';
      document.getElementById('biblia_logline').value = localStorage.getItem('biblia_logline')||'';
      document.getElementById('biblia_sinopse').value = localStorage.getItem('biblia_sinopse')||'';
      document.getElementById('biblia_visual').value = localStorage.getItem('biblia_visual')||'';
      document.getElementById('biblia_episodios').value = localStorage.getItem('biblia_episodios')||'';
      loadStoryboard();
    }
    function saveEscaleta(){localStorage.setItem('escaleta_text',document.getElementById('escaleta_text').value)}
    function saveRoteiro(){localStorage.setItem('roteiro_text',document.getElementById('roteiro_text').value)}
    function saveTratamento(){localStorage.setItem('tratamento_text',document.getElementById('tratamento_text').value)}
    function saveBiblia(){
      localStorage.setItem('biblia_storyline',document.getElementById('biblia_storyline').value);
      localStorage.setItem('biblia_logline',document.getElementById('biblia_logline').value);
      localStorage.setItem('biblia_sinopse',document.getElementById('biblia_sinopse').value);
      localStorage.setItem('biblia_visual',document.getElementById('biblia_visual').value);
      localStorage.setItem('biblia_episodios',document.getElementById('biblia_episodios').value);
    }
    function previewCapa(event){
      var reader=new FileReader();
      reader.onload=function(){
        document.getElementById('biblia_capa_preview').src=reader.result;
        localStorage.setItem('biblia_capa',reader.result);
      }
      reader.readAsDataURL(event.target.files[0]);
    }
    if(localStorage.getItem('biblia_capa')){
      document.getElementById('biblia_capa_preview').src=localStorage.getItem('biblia_capa');
    }

    // Storyboard
    function loadStoryboard(){
      const grid=document.getElementById('storyboard_grid');
      grid.innerHTML='';
      let count=parseInt(localStorage.getItem('storyboard_count'))||3;
      for(let i=1;i<=count;i++){
        createQuadro(i);
      }
    }
    function createQuadro(i){
      const grid=document.getElementById('storyboard_grid');
      const card=document.createElement('div');
      card.className='storyboard-card';
      card.innerHTML=`<input type="file" accept="image/*" onchange="saveQuadroImg(event,${i})">
        <img id="storyboard_img${i}" src="${localStorage.getItem('storyboard_img'+i)||''}">
        <textarea id="storyboard_txt${i}" placeholder="Descrição..." oninput="saveQuadroTxt(${i})">${localStorage.getItem('storyboard_txt'+i)||''}</textarea>`;
      grid.appendChild(card);
    }
    function addQuadro(){
      let count=parseInt(localStorage.getItem('storyboard_count'))||3;
      count++;
      localStorage.setItem('storyboard_count',count);
      createQuadro(count);
    }
    function saveQuadroImg(e,i){
      var reader=new FileReader();
      reader.onload=function(){
        localStorage.setItem('storyboard_img'+i,reader.result);
        document.getElementById('storyboard_img'+i).src=reader.result;
      }
      reader.readAsDataURL(e.target.files[0]);
    }
    function saveQuadroTxt(i){
      localStorage.setItem('storyboard_txt'+i,document.getElementById('storyboard_txt'+i).value);
    }

    // Fofoca
    function sendMessage(){
      const input=document.getElementById('chatInput');
      const msg=input.value.trim();
      if(msg){
        const div=document.createElement('div');
        div.className='message sent';
        div.textContent=msg;
        document.getElementById('chatMessages').appendChild(div);
        input.value='';
      }
    }

    // Chama
    function toggleCam(){alert('Câmera ligada/desligada (protótipo)');}
    function toggleMic(){alert('Mic ligado/desligado (protótipo)');}
    function shareScreen(){alert('Compartilhar tela (protótipo)');}
    function endCall(){alert('Chamada encerrada (protótipo)');}
  </script>
</body>
</html>

